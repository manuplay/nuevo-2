<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kardex Farmacol√≥gico - Ficha Completa por Medicamento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
            color: #1f2937;
        }
        .ficha-header {
            background-color: #3b82f6;
            color: white;
            padding: 1rem;
            border-radius: 0.75rem 0.75rem 0 0;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .ficha-header:hover {
            background-color: #2563eb;
        }
        .ficha-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out;
            background-color: white;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 0.75rem 0.75rem;
        }
        .ficha-content.open {
            max-height: 2000px; /* Suficiente altura para expandir */
        }
        .campo-label {
            font-weight: 600;
            color: #1f2937;
            background-color: #eef2ff; /* Azul muy claro para el fondo del label */
            padding: 0.5rem 1rem;
            border-right: 1px solid #e5e7eb;
            width: 30%; /* Ancho fijo para las etiquetas */
        }
        .campo-valor {
            padding: 0.5rem 1rem;
            color: #4b5563;
            width: 70%;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="mb-8">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-700">üìã Fichas Farmacol√≥gicas: Formato Completo</h1>
            <p class="mt-2 text-lg text-slate-600">Cada ficha se muestra en su formato detallado. Use los controles para filtrar la informaci√≥n y ver solo las fichas relevantes.</p>
        </header>

        <!-- Search, Filter, and UX Controls -->
        <div class="bg-white p-4 sm:p-6 rounded-xl shadow-lg mb-6">
            <h2 class="text-xl font-semibold text-slate-800 mb-4 border-b pb-2">üîé Controles de B√∫squeda y Filtrado</h2>
            <div class="flex flex-col md:flex-row gap-4 mb-4">
                <input type="text" id="searchInput" placeholder="Buscar por Nombre (Comercial o Gen√©rico)..."
                       class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                
                <select id="groupFilter" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 md:w-1/4">
                    <option value="all">Filtrar por Grupo Farmacol√≥gico</option>
                    <!-- Opciones a√±adidas por JS -->
                </select>
                
                <select id="routeFilter" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 md:w-1/4">
                    <option value="all">Filtrar por V√≠a de Administraci√≥n</option>
                    <!-- Opciones a√±adidas por JS -->
                </select>
            </div>
            <div class="flex justify-between items-center">
                <button id="clearFiltersBtn" class="p-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition duration-150">
                    Limpiar Filtros
                </button>
                <p id="resultsCount" class="text-lg font-medium text-slate-700">Mostrando 80 resultados totales.</p>
            </div>
        </div>

        <!-- Medication List -->
        <div id="medicationList" class="space-y-4">
            <!-- Fichas inyectadas por JS -->
        </div>

    </div>

    <script>
        // --- DATA GENERATION (80 FICHAS COMPLETAS) ---

        const data = (() => {
            const medicamentos = [];
            const nombresGenericos = [
                "Paracetamol", "Ibuprofeno", "Amoxicilina", "Omeprazol", "Losart√°n", 
                "Metformina", "Atorvastatina", "Tramadol", "Amlodipino", "Ceftriaxona",
                "Furosemida", "Clonazepam", "Heparina", "Insulina Glargina", "Levotiroxina", 
                "Salbutamol", "Prednisona", "Metronidazol", "Diclofenaco", "Ranitidina"
            ];
            const nombresComerciales = [
                "Tylenol", "Advil", "Amoxil", "Prilosec", "Cozaar", 
                "Glucophage", "Lipitor", "Ultram", "Norvasc", "Rocephin",
                "Lasix", "Klonopin", "Clexane", "Lantus", "Eutirox", 
                "Ventolin", "Deltasone", "Flagyl", "Voltaren", "Zantac"
            ];
            const gruposFarmacologicos = [
                "Analg√©sico/Antipir√©tico", "AINE (Antiinflamatorio)", "Antibi√≥tico Beta-Lact√°mico", 
                "Inhibidor de Bomba de Protones", "Antagonista de Receptores de Angiotensina II", 
                "Antidiab√©tico Oral", "Estatina (Hipolipemiante)", "Analg√©sico Opioide", 
                "Bloqueador de Canales de Calcio", "Cefalosporina de Tercera Generaci√≥n",
                "Diur√©tico de Asa", "Benzodiacepina (Ansiol√≠tico)", "Anticoagulante", 
                "Insulina de Acci√≥n Prolongada", "Hormona Tiroidea", "Agonista Beta-2",
                "Corticoesteroide", "Antiprotozoario", "AINE (T√≥pico/Oral)", "Bloqueador H2"
            ];
            const vias = ["Oral", "Intravenosa (IV)", "Intramuscular (IM)", "Subcut√°nea (SC)", "Inhalatoria"];
            const presentaciones = [
                "Tabletas (10 unidades)", "C√°psulas (30 unidades)", "Ampolla (1 g/10 ml)", 
                "Frasco vial (50 mg)", "Soluci√≥n Inyectable (20 mg)", "Jeringa Prellenada (40 mg)",
                "Inhalador (100 mcg/pulsaci√≥n)", "Supositorios (300 mg)"
            ];
            const mecanismos = [
                "Inhibici√≥n de la s√≠ntesis de prostaglandinas en el SNC.", 
                "Inhibici√≥n de la ciclooxigenasa (COX-1 y COX-2).",
                "Inhibici√≥n de la s√≠ntesis de la pared celular bacteriana (transpeptidasas).",
                "Bloqueo irreversible de la H+/K+-ATPasa en c√©lulas parietales g√°stricas.",
                "Bloqueo selectivo y competitivo de los receptores AT1 de la angiotensina II.",
                "Reduce la producci√≥n hep√°tica de glucosa (gluconeog√©nesis) y mejora la sensibilidad perif√©rica a la insulina.",
                "Inhibici√≥n competitiva de la enzima HMG-CoA reductasa, limitando la bios√≠ntesis de colesterol.",
                "Agonista d√©bil de receptores opioides mu y tambi√©n inhibe la recaptaci√≥n de norepinefrina y serotonina.",
                "Inhibe la entrada de iones de calcio a trav√©s de las membranas de las c√©lulas musculares lisas vasculares y card√≠acas.",
                "Inhibici√≥n de la s√≠ntesis de peptidoglicano de la pared bacteriana, un efecto bactericida.",
                "Bloquea el cotransportador Na+-K+-2Cl- en la rama ascendente gruesa del asa de Henle.",
                "Potencia el efecto inhibidor del neurotransmisor GABA, aumentando la frecuencia de apertura de canales de cloruro.",
                "Potencia la inhibici√≥n de la trombina y el factor Xa por la antitrombina III.",
                "An√°logo de insulina basal que proporciona un perfil de concentraci√≥n relativamente constante y sin picos.",
                "Reemplazo de la hormona tiroidea end√≥gena (T4), actuando sobre los receptores nucleares.",
                "Estimula selectivamente los receptores adren√©rgicos beta-2 en el m√∫sculo liso bronquial, causando broncodilataci√≥n.",
                "Se une a receptores de glucocorticoides intracelulares, modificando la transcripci√≥n gen√©tica para efectos antiinflamatorios e inmunosupresores.",
                "Alteraci√≥n del ADN y generaci√≥n de radicales libres citot√≥xicos en organismos anaerobios y protozoos sensibles.",
                "Inhibici√≥n potente y no selectiva de la s√≠ntesis de prostaglandinas por la inhibici√≥n de COX.",
                "Bloqueo competitivo y reversible de los receptores H2 de la histamina en las c√©lulas parietales g√°stricas."
            ];
            const indicaciones = [
                ["Dolor leve a moderado", "Fiebre (Antipir√©tico)"], 
                ["Dolor, inflamaci√≥n (articular y muscular)", "Artritis", "Dismenorrea"],
                ["Infecciones respiratorias (neumon√≠a, bronquitis)", "Otitis media", "Sinusitis"],
                ["Enfermedad por Reflujo Gastroesof√°gico (ERGE)", "√ölcera p√©ptica (g√°strica y duodenal)", "Eradicaci√≥n de H. pylori"],
                ["Hipertensi√≥n arterial (HTA)", "Insuficiencia card√≠aca", "Nefropat√≠a diab√©tica"],
                ["Diabetes Mellitus tipo 2 (monoterapia o combinado)"],
                ["Hipercolesterolemia primaria", "Prevenci√≥n secundaria de eventos cardiovasculares"],
                ["Dolor moderado a severo (agudo y cr√≥nico)"],
                ["Hipertensi√≥n arterial", "Angina estable cr√≥nica", "Angina de Prinzmetal"],
                ["Infecciones graves del tracto respiratorio, sepsis, meningitis"],
                ["Edema asociado a insuficiencia card√≠aca congestiva", "Hipertensi√≥n", "Insuficiencia renal"],
                ["Trastorno de ansiedad", "Trastorno de p√°nico", "Epilepsia (tratamiento adjunto)"],
                ["Profilaxis y tratamiento de la trombosis venosa profunda (TVP)", "Embolia pulmonar (EP)"],
                ["Tratamiento de Diabetes Mellitus tipo 1 y 2 (Control basal o nocturno)"],
                ["Hipotiroidismo de cualquier etiolog√≠a", "Supresi√≥n de TSH en c√°ncer tiroideo"],
                ["Asma (alivio de s√≠ntomas agudos)", "Enfermedad Pulmonar Obstructiva Cr√≥nica (EPOC)"],
                ["Trastornos inflamatorios y autoinmunes (Lupus, Artritis Reumatoide)", "Alergias severas"],
                ["Infecciones por protozoos (Amebiasis, Giardiasis)", "Infecciones bacterianas anaerobias"],
                ["Dolor e inflamaci√≥n articular, gota, esguinces", "Dolor postoperatorio"],
                ["√ölcera duodenal y g√°strica activa", "S√≠ndrome de Zollinger-Ellison"]
            ];
            const posologias = [
                "Adultos: 500 mg a 1 g cada 6-8 horas, Dosis m√°xima diaria: 4 g.", 
                "Adultos: 200 a 400 mg cada 6-8 horas. M√°ximo: 1200 mg/d√≠a.",
                "Adultos: 500 mg a 1 g cada 8 horas, por 7 a 14 d√≠as.",
                "ERGE: 20 mg una vez al d√≠a. √ölcera: 40 mg una vez al d√≠a.",
                "Iniciar con 50 mg una vez al d√≠a. Rango de mantenimiento: 25 a 100 mg/d√≠a.",
                "Iniciar con 500 mg dos veces al d√≠a con las comidas. Dosis m√°xima: 2550 mg/d√≠a.",
                "Dosis inicial: 10 mg o 20 mg. Rango de dosis: 10 mg a 80 mg una vez al d√≠a.",
                "50 mg a 100 mg cada 4-6 horas seg√∫n necesidad. Dosis m√°xima: 400 mg/d√≠a.",
                "5 mg una vez al d√≠a. Se puede aumentar a un m√°ximo de 10 mg/d√≠a.",
                "Adultos: 1 a 2 g una vez al d√≠a (IV o IM) seg√∫n la gravedad de la infecci√≥n.",
                "Inicialmente 20-40 mg oral. Ajustar seg√∫n la respuesta diur√©tica.",
                "0.5 mg a 2 mg al acostarse para la ansiedad o p√°nico. Ajustar individualmente.",
                "Profilaxis: 40 mg SC una vez al d√≠a. Tratamiento: 1 mg/kg SC cada 12 horas.",
                "Dosis individualizada SC, usualmente una vez al d√≠a, independientemente de las comidas.",
                "Dosis inicial: 1.6 mcg/kg/d√≠a. Ajustar la dosis en incrementos de 12.5 mcg.",
                "2 inhalaciones (200 mcg) cada 4 a 6 horas PRN (seg√∫n necesidad) para broncoespasmo.",
                "Dosis muy variable, desde 5 mg hasta 60 mg/d√≠a, seg√∫n la condici√≥n a tratar.",
                "500 mg por v√≠a oral cada 8 horas, por 7 a 10 d√≠as.",
                "50 a 100 mg dos o tres veces al d√≠a con comida. V√≠a t√≥pica: aplicar 3-4 veces al d√≠a.",
                "150 mg dos veces al d√≠a o 300 mg al acostarse."
            ];

            for (let i = 0; i < 80; i++) {
                const index = i % 20;
                const presentationIndex = i % presentaciones.length;
                const posologiaIndex = i % posologias.length;
                const viaIndex = i % vias.length;

                medicamentos.push({
                    id: i + 1,
                    nombreComercial: nombresComerciales[index] + (i < 20 ? "" : (i < 40 ? " Forte" : (i < 60 ? " XR" : " Plus"))),
                    nombreGenerico: nombresGenericos[index],
                    mecanismoAccion: mecanismos[index],
                    presentacion: presentaciones[presentationIndex],
                    indicadores: indicaciones[index],
                    viaAdministracion: vias[viaIndex],
                    grupoFarmacologico: gruposFarmacologicos[index],
                    posologia: posologias[posologiaIndex]
                });
            }
            return medicamentos;
        })();

        // --- STATE MANAGEMENT ---
        
        const state = {
            data: data,
            filters: {
                search: "",
                group: "all",
                route: "all"
            }
        };

        // --- SELECTORS ---
        const medicationList = document.getElementById('medicationList');
        const searchInput = document.getElementById('searchInput');
        const groupFilter = document.getElementById('groupFilter');
        const routeFilter = document.getElementById('routeFilter');
        const resultsCountEl = document.getElementById('resultsCount');
        const clearFiltersBtn = document.getElementById('clearFiltersBtn');

        // --- FILTERING AND RENDERING LOGIC ---

        function getFilteredData() {
            return state.data.filter(med => {
                const matchSearch = med.nombreComercial.toLowerCase().includes(state.filters.search.toLowerCase()) || 
                                    med.nombreGenerico.toLowerCase().includes(state.filters.search.toLowerCase());
                const matchGroup = state.filters.group === 'all' || med.grupoFarmacologico === state.filters.group;
                const matchRoute = state.filters.route === 'all' || med.viaAdministracion === state.filters.route;
                return matchSearch && matchGroup && matchRoute;
            });
        }

        function toggleFicha(id) {
            const content = document.getElementById('content-' + id);
            const isExpanded = content.classList.contains('open');
            
            // Cierra todas las dem√°s fichas abiertas (opcional, para limpieza)
            document.querySelectorAll('.ficha-content.open').forEach(item => {
                if (item.id !== content.id) {
                     item.classList.remove('open');
                }
            });

            // Togglea la ficha seleccionada
            if (isExpanded) {
                content.classList.remove('open');
            } else {
                content.classList.add('open');
            }
        }
        
        // Exponer la funci√≥n globalmente para el onclick en HTML
        window.toggleFicha = toggleFicha;

        function renderList() {
            const filtered = getFilteredData();
            const filteredCount = filtered.length;
            
            resultsCountEl.textContent = `Mostrando ${filteredCount} resultado${filteredCount !== 1 ? 's' : ''} de 80 totales.`;

            medicationList.innerHTML = '';

            if (filteredCount === 0) {
                 medicationList.innerHTML = `<div class="p-6 text-center bg-white rounded-xl shadow-md text-gray-500 text-lg font-semibold">‚ùå No se encontraron resultados para los filtros aplicados.</div>`;
                 return;
            }

            filtered.forEach(med => {
                // 1. Crear el contenedor de la ficha
                const fichaContainer = document.createElement('div');
                fichaContainer.className = 'rounded-xl shadow-md';
                
                // 2. Crear el encabezado (clickable)
                const header = document.createElement('div');
                header.className = 'ficha-header flex justify-between items-center text-lg font-bold';
                header.setAttribute('onclick', `toggleFicha(${med.id})`);
                header.innerHTML = `
                    <span>${med.nombreGenerico} <span class="text-sm font-normal text-blue-200">(${med.nombreComercial})</span></span>
                    <span class="text-sm font-light">${med.grupoFarmacologico}</span>
                `;
                fichaContainer.appendChild(header);

                // 3. Crear el cuerpo de la ficha (el formato completo)
                const content = document.createElement('div');
                content.id = 'content-' + med.id;
                content.className = 'ficha-content';
                
                // Generar las filas de la tabla interna (formato completo de ficha)
                let htmlContent = `<div class="p-4">`;
                
                const fields = [
                    { label: "NOMBRE COMERCIAL", value: med.nombreComercial },
                    { label: "NOMBRE GEN√âRICO", value: med.nombreGenerico },
                    { label: "MECANISMO DE ACCI√ìN", value: med.mecanismoAccion },
                    { label: "PRESENTACI√ìN", value: med.presentacion },
                    { label: "INDICACIONES", value: `<ul>${med.indicadores.map(i => `<li>${i}</li>`).join('')}</ul>` },
                    { label: "V√çA DE ADMINISTRACI√ìN", value: med.viaAdministracion },
                    { label: "GRUPO FARMACOL√ìGICO", value: med.grupoFarmacologico },
                    { label: "POSOLOG√çA", value: med.posologia },
                ];

                fields.forEach(field => {
                    htmlContent += `
                        <div class="flex border-b border-gray-200">
                            <div class="campo-label text-sm uppercase">${field.label}</div>
                            <div class="campo-valor text-sm">${field.value}</div>
                        </div>
                    `;
                });
                
                htmlContent += `</div>`;
                content.innerHTML = htmlContent;
                fichaContainer.appendChild(content);

                medicationList.appendChild(fichaContainer);
            });
        }

        function clearFilters() {
            state.filters.search = "";
            state.filters.group = "all";
            state.filters.route = "all";
            
            // Reset UI elements
            searchInput.value = "";
            groupFilter.value = "all";
            routeFilter.value = "all";

            renderList();
        }

        // --- INITIALIZATION ---
        
        function populateFilters() {
            const groups = [...new Set(data.map(m => m.grupoFarmacologico))].sort();
            const routes = [...new Set(data.map(m => m.viaAdministracion))].sort();

            groups.forEach(g => {
                const option = document.createElement('option');
                option.value = g;
                option.textContent = g;
                groupFilter.appendChild(option);
            });

            routes.forEach(r => {
                const option = document.createElement('option');
                option.value = r;
                option.textContent = r;
                routeFilter.appendChild(option);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            populateFilters();
            renderList();

            // Event Listeners for Controls
            searchInput.addEventListener('input', () => {
                state.filters.search = searchInput.value;
                renderList();
            });

            groupFilter.addEventListener('change', () => {
                state.filters.group = groupFilter.value;
                renderList();
            });
            
            routeFilter.addEventListener('change', () => {
                state.filters.route = routeFilter.value;
                renderList();
            });

            clearFiltersBtn.addEventListener('click', clearFilters);
        });

    </script>
</body>
</html>